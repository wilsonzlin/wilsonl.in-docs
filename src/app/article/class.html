<template ooml-class="ArticleSignature">
    <ooml-property name="code"
                   set="return { HTML: newValue ? ('<span>' + wl.Docs.parseTypedCodeLine(newValue) + '</span>') : '' }"
    >null</ooml-property>

    <ooml-method name="serialise">
        function() {
            return this.code;
        }
    </ooml-method>
    <ooml-method name="unserialise">
        function(code) {
            return { code: code };
        }
    </ooml-method>

    <pre class="signature">{{ this.code }}</pre>
</template>

<template ooml-class="ArticleArgument">
    <ooml-property name="description"
                   set="return { HTML: newValue ? wl.Docs.parseMarkdown(newValue) : '' }"
    >null</ooml-property>

    <div>
        <dt class="argument-name">{{ this.name }}</dt>
        <dd>
            <p class="argument-description">{{ this.description }}</p>
        </dd>
    </div>
</template>

<template ooml-class="ArticleReturn">
    <ooml-property name="value"
                   set="return { HTML: newValue ? wl.Docs.parseMarkdown(newValue) : '' }"
    >null</ooml-property>

    <ooml-method name="serialise">
        function() {
            return this.value;
        }
    </ooml-method>
    <ooml-method name="unserialise">
        function(value) {
            return { value: value };
        }
    </ooml-method>

    <li>{{ this.value }}</li>
</template>

<template ooml-class="ArticleNotice">
    <div class="notice">
        <h3></h3>
        <p></p>
    </div>
</template>

<template ooml-abstract-class="AppArticle">
    <ooml-attribute name="hidden" type="boolean">true</ooml-attribute>
    <ooml-attribute name="categoryName" type="string">''</ooml-attribute>

    <ooml-method name="abstractFactory">
        function(initState, classes) {
            return new (initState.content ? classes.ContentArticle : classes.ReferenceArticle)(initState);
        }
    </ooml-method>
</template>

<template ooml-class="ReferenceArticle extends AppArticle">
    <ooml-method name="constructor">
        function() {
            if (!this.arguments.length) {
                this.$argumentsSection.style.display = 'none';
            }
            if (!this.returns.length) {
                this.$returnsSection.style.display = 'none';
            }
        }
    </ooml-method>

    <article>
        <header>
            <div class="category" domonclick="dispatch('clickcategory')">{{ this.attributes.categoryName }}</div>
            <h1>{{ this.name }}</h1>
            <div class="versions">{{ this.versions }}</div>
        </header>

        <section class="section-synopsis">
            <h2>Synopsis</h2>
            <p class="description">{{ this.description }}</p>
            <ooml-substitution array property="signatures" class="ArticleSignature"></ooml-substitution>
        </section>

        <section ooml-expose="argumentsSection">
            <h2>Arguments</h2>
            <dl class="arguments-list">
                <ooml-substitution array property="arguments" class="ArticleArgument"></ooml-substitution>
            </dl>
        </section>

        <section ooml-expose="returnsSection">
            <h2>Returns</h2>
            <ul class="returns-list">
                <ooml-substitution array property="returns" class="ArticleReturn"></ooml-substitution>
            </ul>
        </section>
    </article>
</template>

<template ooml-class="ContentArticle extends AppArticle">
    <ooml-property name="content" type="string" set="if (typeof newValue == 'string') return { HTML: '<div>' + marked(newValue) + '</div>' }">''</ooml-property>
    <ooml-property name="description" type="string">''</ooml-property>

    <article>
        <header>
            <div class="category" domonclick="dispatch('clickcategory')">{{ this.attributes.categoryName }}</div>
            <h1>{{ this.name }}</h1>
            <div class="versions">{{ this.versions }}</div>
        </header>

        <section>{{ this.content }}</section>
    </article>
</template>
