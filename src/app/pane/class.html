<template ooml-class="PaneTocCategoryEntry">
    <ooml-attribute name="active" type="boolean">false</ooml-attribute>
    <ooml-attribute name="hidden" type="boolean">false</ooml-attribute>
    <ooml-attribute name="article">null</ooml-attribute>

    <li class="toc-category-entry" title="{{ this.description }}" domonclick="dispatch('click', { entry: this })">{{ this.name }}</li>
</template>

<template ooml-class="PaneTocCategory">
    <ooml-attribute name="expanded" type="boolean">true</ooml-attribute>

    <div class="toc-category">
        <dt class="toc-category-label" domonclick="this.attributes.expanded = !this.attributes.expanded">{{ this.name }}</dt>
        <dd class="toc-category-entries-container">
            <ul class="toc-category-entries">
                <ooml-substitution array property="entries" class="PaneTocCategoryEntry" dispatchonclick="dispatch('clickentry', { entry: data.entry })"></ooml-substitution>
            </ul>
        </dd>
    </div>
</template>

<template ooml-class="AppPane">
    <ooml-attribute name="mobileVisible" type="boolean">true</ooml-attribute>

    <nav>
        <h1>Table of Contents</h1>
        <input id="toc-search" domoninput="
            let term = $self.value.trim() || false;
            let regexp = term && RegExp(wl.Docs.escapeRegExp($self.value.trim()), 'i');

            this.categories.forEach(c => c.entries.forEach(entry => entry.attributes.hidden = term && !regexp.test(entry.name)));
        ">
        <span id="toc-controls">
            <button class="toc-control" domonclick="this.categories.forEach(cat => cat.attributes.expanded = true)">Expand all</button>
            <button class="toc-control" domonclick="this.categories.forEach(cat => cat.attributes.expanded = false)">Collapse all</button>
        </span>
        <dl id="toc-categories">
            <ooml-substitution array property="categories" class="PaneTocCategory" dispatchonclickentry="dispatch('clickentry', data)"></ooml-substitution>
        </dl>
    </nav>
</template>
