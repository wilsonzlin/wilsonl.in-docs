<ZC-IMPORT[article/class.html]>
<ZC-IMPORT[footer/class.html]>
<ZC-IMPORT[header/class.html]>
<ZC-IMPORT[pane/class.html]>

<template ooml-class="App">
    <ooml-attribute name="currentArticle">null</ooml-attribute>
    <ooml-attribute name="currentArticleEntry">null</ooml-attribute>
    <ooml-attribute name="darkTheme" type="boolean">false</ooml-attribute>

    <ooml-method name="loadArticle">
        function(article) {
            /* Update viewport */
            this.$app.scrollTop = 0;
            document.title = `${ wl.Docs.currentListing }${ wl.Docs.DOCUMENT_TITLE_SUFFIX }`;
            this.pane.attributes.mobileVisible = false;

            /* Load article */
            if (this.attributes.currentArticle) {
                this.attributes.currentArticle.attributes.hidden = true;
            }

            if (article) {
                article.attributes.hidden = false;
                document.title = `${ article.name } - ${ wl.Docs.currentListing }${ wl.Docs.DOCUMENT_TITLE_SUFFIX }`;

                /* Add hash to URL without creating history */
                history.replaceState(undefined, undefined, '#' + article.name);
            }
            this.attributes.currentArticle = article || null;
        }
    </ooml-method>

    <div id="app" ooml-expose="app">
        <ooml-substitution property="header" class="AppHeader"
            dispatchontoggledarktheme="localStorage.wilsonlin_docs_darkTheme = this.attributes.darkTheme = !this.attributes.darkTheme"
        ></ooml-substitution>
        <main>
            <ooml-substitution property="pane" class="AppPane" dispatchonclickentry="
                if (this.attributes.currentArticleEntry) {
                    this.attributes.currentArticleEntry.attributes.active = false;
                }
                this.attributes.currentArticleEntry = data.entry;
                data.entry.attributes.active = true;

                this.loadArticle(data.entry.attributes.article);
            "></ooml-substitution>
            <div id="articles">
                <ooml-substitution array property="articles" class="AppArticle" dispatchonclickcategory="this.pane.attributes.mobileVisible = true"></ooml-substitution>
            </div>
        </main>
        <ooml-substitution property="footer" class="AppFooter"></ooml-substitution>
    </div>
</template>
<div ooml-instantiate="App app">{
    header: {},
    pane: {},
    footer: {},
}</div>
